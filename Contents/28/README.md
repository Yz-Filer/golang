[go言語 & gotk3をちょっとやり直してみたい](../../README.md#go%E8%A8%80%E8%AA%9Egotk3%E3%82%92%E3%81%A1%E3%82%87%E3%81%A3%E3%81%A8%E3%82%84%E3%82%8A%E7%9B%B4%E3%81%97%E3%81%A6%E3%81%BF%E3%81%9F%E3%81%84)  

# 28. （まとめ2）タブ切り替え型の簡易メモ帳～はじめに～  

タブ切り替え型のメモ帳もどきを作成してみたいと思います。  
TextViewを使いますので、半角スペース/全角スペース/タブ/改行コードなどを画面に表示することが出来ず、機能も限定的な物しか実装しないため、有償/無償で公開されてる多くのエディタの代替にはならないと思いますが、お題として思いついたのでやってみます。  

## 28.1 事前確認が必要な物  

「付箋」の時と違い特に画面間の遷移などがないため、全体イメージなどは作成せず、必要な機能の確認からしていきます。  

- 動的に追加するTabControl（Notebook）  
  タブ切り替え型のメモ帳なので、新規作成/ファイルオープン時に動的にタブを追加する方法を確認します。uiの作成はgladeで行います。  
- 文字コード判定  
  ファイルオープン時に文字コードを自動判定する方法を確認します。  
- 拡大/縮小  
  TextViewに表示されてるテキストを拡大/縮小する方法を確認します。  
- UNDO/REDO  
  UNDO/REDOの実装方法を確認します。  

今回は、以下の機能は実装していません。  

- 検索/置換  
  `TextIter.ForwardSearch()`/`TextIter.BackwardSearch()`で検索は可能なので、検索後に、置換をすることも出来ると思います。  
  正規表現で検索したい場合は、TextBufferから全テキストを取得した後、go言語側の関数で検索し、オフセット位置からTextIterを取得すれば正規表現での検索も可能だと思います。  
- 半角スペース/全角スペース/タブを視覚的に判別できるようにする  
  TextViewでは、半角スペース/全角スペース/タブを別の文字に置き換えて視覚的に判別出来るように表示することは出来ないようです。ただし、TextTagを使えば背景色の変更などは出来るので、それぞれ別の背景色に設定すれば、視覚的に判別できるようにすることは可能です。  
  TextTagを使う場合は、1文字1文字検査してTextTagを適用する必要があるので、大きいファイルを開いた場合など、処理性能に影響があるかもしれません。また、キー入力時やペースト時に入力された文字を検査する必要があります。  
- 改行コードを視覚的に判別できるようにする  
  「半角スペース/全角スペース/タブ」と異なり、改行コードは画面に表示されない（幅が0となる）ため、背景色を変更しても視覚的に判別出来ません。  
  WEB検索してもGeminiに聞いても、解決する方法は見つかりませんでした。  

</br>

「[29. （まとめ2）動的に追加するTabControl（Notebook）](../29/README.md)」へ
